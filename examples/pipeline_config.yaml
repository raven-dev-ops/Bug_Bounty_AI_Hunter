schema_version: "0.1.0"
limits:
  request_budget: 500
  token_budget: 20000
  max_concurrency: 3
  min_delay_seconds: 0.2
  timeout_seconds: 10
  stage_timeout_seconds: 300
stages:
  - name: scope_import
    config:
      input: examples/scope_generic.json
      format: generic
      output: output/target_profile.json
  - name: dataflow_map
    config:
      target_profile: output/target_profile.json
      output: output/dataflow_map.json
  - name: threat_model
    config:
      target_profile: output/target_profile.json
      output: output/threat_model.json
  - name: discovery
    config:
      target_profile: output/target_profile.json
      output: output/discovery.json
      prefixes: [www, api, staging]
  - name: scan
    config:
      templates: templates
      targets: output/discovery.json
      output: output/scan_results.json
      max_concurrency: 3
      min_delay_seconds: 0.2
      canary: CANARY-1234
      estimated_requests: 50
  - name: triage
    config:
      input: output/scan_results.json
      output: output/triage.json
      estimated_tokens: 2000
  - name: intel
    config:
      source: examples/intel_stub.json
      targets: output/discovery.json
      output: output/intel.json
      provider: file
      timeout_seconds: 10
      estimated_requests: 5
  - name: report_bundle
    config:
      findings: examples/outputs/findings.json
      target_profile: output/target_profile.json
      evidence: examples/evidence_example.json
      output_dir: output/report_bundle
      repro_steps: examples/repro_steps.json
  - name: issue_drafts
    config:
      findings: output/report_bundle/findings.json
      target_profile: output/target_profile.json
      output_dir: output/issue_drafts
      platform: github
      attachments_manifest: output/report_bundle/attachments_manifest.json
  - name: finding_reports
    config:
      findings: output/report_bundle/findings.json
      evidence: examples/evidence_example.json
      output_dir: output/finding_reports
      attachments_manifest: output/report_bundle/attachments_manifest.json
  - name: jira_export
    config:
      findings: output/report_bundle/findings.json
      output: output/jira_issues.csv
  - name: summary_export
    config:
      findings: output/report_bundle/findings.json
      output_dir: output/summary
  - name: pdf_export
    config:
      input: output/report_bundle/report.md
      output: output/report_bundle/report.pdf
  - name: notify
    config:
      input: output/triage.json
      channel: console
